\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[left=1cm,right=1cm,top=1cm,bottom=2cm]{geometry}
\usepackage[table]{xcolor}
\usepackage{fmtcount}
\usepackage{tcolorbox}
\usepackage{fancybox}
\usepackage{color}
\usepackage[autolanguage,np]{numprint}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{longtable, array}
\usepackage{eso-pic}
\usepackage{ulem}
\usepackage{babel}[french]
\usepackage{array}

\graphicspath{ {\VAR{image_path}} }
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}} %Permet d'avoir des colonnes de taille fixe et centrées.

\pagestyle{fancyplain}
\cfoot{\vspace{-.5cm}Institut de formation aux normes et technologies de l'informatique\\300 BP 40, Sokodé TOGO -- Tél. : +228 90 91 81 41\\Agrément N\textdegree2019/064/MESR/SG/DES}
\renewcommand{\headrulewidth}{0pt}

\title{\vspace{10cm} {\LARGE \uuline{\textbf{CAHIER DE TEXTE} \\ \textbf{\VAR{semestre}} }}}
\date{}


\newcommand\BackgroundPic{
\put(0,0){
\parbox[b][\paperheight]{\paperwidth}{
	\includegraphics[width=\paperwidth,height=\paperheight]{CharteGraphiqueDocumentCahierDeTexte.png}
	}}}

\begin{document}



\newcommand{\Col}[2]{%
\boxput*(0,1){\colorbox{white}{#1}}%
{\setlength{\fboxsep}{12pt}%
\fbox{\begin{Bflushleft}%
#2\end{Bflushleft}}}}

\AddToShipoutPicture{\BackgroundPic}
\maketitle\vspace{1cm}
\vspace{-13cm} \hspace{6cm} \includegraphics[scale=1]{logo.jpeg}
\noindent



\vspace{10cm}
\null\hfill Fait à Sokodé, le \today\\
\null\hfill Le Responsable d'établissement\\

%\hspace{7cm} \includegraphics[width=10cm]{/home/manaar/manaar/notes/releve_note/releve_2014/signature_sab.png}

\vspace{1.5cm}

\null\hfill Sabirou TÉOURI

\vfill

\newpage
\hspace{4.5cm} \vspace{1.5cm} {\LARGE \uline{\textbf{Details Du Semestre \VAR{semestre}}}}


\BLOCK{if listeUe == 'on'}
\hspace{4.5cm}{\Large \uline{\textbf{Liste Des Ues}}}
	\begin{center}
		\begin{tabular}{|>{\raggedright}p{6cm}|P{2.1cm}|P{2.6cm}|P{2.4cm}|}
			\hline
			\textbf{Code \& Libellé} & \textbf{Type} & \textbf{Nombre d'heure} & \textbf{Nombre de Credit}\\
			\hline
		\BLOCK{for ue in ues}
		\VAR{ue.codeUE}::\VAR{ue.libelle} & \VAR{ue.type} &\VAR{ue.heures}  & \VAR{ue.nbreCredits}\\
		\hline
		\BLOCK{endfor}
		\end{tabular}
	\end{center}
\BLOCK{endif}

\BLOCK{if listeEtudiant == 'on'}
\hspace{4.5cm}{\Large \uline{\textbf{Liste Des Etudiants}}}
	\begin{center}
		\begin{tabular}{|>{\raggedright}p{4.3cm}|P{1.8cm}|P{5cm}|P{2.5cm}|}
			\hline
			\textbf{Prénom \& Nom} & \textbf{Contact} & \textbf{Mail} & \textbf{Username}\\
			\hline
		\BLOCK{for etudiant in etudiants}
		\VAR{etudiant.prenom} \VAR{etudiant.nom} & \VAR{etudiant.contact} &\VAR{etudiant.email}  & \VAR{etudiant.user}\\
		\hline
		\BLOCK{endfor}
	\end{tabular}
	\end{center}
\BLOCK{endif}
\BLOCK{if listeMatiere == 'on'}
\vspace{2cm}\hspace{4.5cm}{\Large \uline{\textbf{Liste Des Matieres}}}
	\begin{center}
		\begin{tabular}{|>{\raggedright}p{5cm}|P{1.8cm}|P{1.5cm}|P{2cm}|P{4.3cm}|}
			\hline
			\textbf{Code \& Libellé} & \textbf{Coefficient} & \textbf{Heures} & \textbf{Abbreviation} \\
			\hline
		\BLOCK{for mat in matieres}
		\VAR{mat.codematiere} \VAR{mat.libelle} & \VAR{mat.coefficient} &\VAR{mat.heures}  & \VAR{mat.abbreviation} \\
		\hline
		\BLOCK{endfor}
	\end{tabular}
	\end{center}
\BLOCK{endif}

\newpage
\clearpage % or \cleardoublepage

\BLOCK{if sousCategorisation == 'parMatieres'}
	\BLOCK{for mat  in seances}
		.

		{\vspace{6cm}\hspace{2.5cm}\LARGE Matiere : \textbf{\VAR{mat}}} \\
	
		{\vspace{2cm}\hspace{2.5cm}\LARGE Heures Prévues : \textbf{\VAR{seances[mat].HeurePrevues}}}\\
 
		{\vspace{2cm}\hspace{2.5cm}\LARGE Heures Consommées : \textbf{\VAR{seances[mat].HeureConsomme}}}\\

		{\vspace{2cm}\hspace{2.5cm}\LARGE Nombres de Séances : \textbf{\VAR{seances[mat].seances|length}}}\\

		{\vspace{2cm}\hspace{2.5cm}\LARGE UE : \textbf{\VAR{seances[mat].UE.libelle}}}\\

		{\vspace{2cm}\hspace{2.5cm}\LARGE Professeur Responsable : \textbf{\VAR{seances[mat].Prof}}}\\


		\newpage
		\begin{longtable}{|P{4cm}|P{9cm}|P{4cm}|}
			\hline
			\LARGE\textbf{Date} & \LARGE \textbf{Description} & \LARGE \textbf{Autres} \\
			\hline
			
			\BLOCK{for cour in seances[mat].seances}
				\rule[-1ex]{0pt}{2.5ex}\underline{Date}: \vspace{1cm} \VAR{cour.date_et_heure_debut.day} - \VAR{cour.date_et_heure_debut.month} - \VAR{cour.date_et_heure_debut.year}
				\vspace{1cm}    
				\underline{Heure}:
				\vspace{1cm} 
				\VAR{cour.date_et_heure_debut.hour}h:\VAR{cour.date_et_heure_debut.minute} - \VAR{cour.date_et_heure_fin.hour}h:\VAR{cour.date_et_heure_fin.minute} 
				\vspace{1cm}
				\underline{Auteur}:
				\vspace{1cm}
				\VAR{cour.auteur.prenom} \VAR{cour.auteur.nom}
				\vspace{1cm}
				\BLOCK{if listeAbsence =="on"}
				\underline{Absents}:
				\vspace{1cm}
				\BLOCK{for eleve in cour.eleves_presents.all()}
					\VAR{eleve.prenom} \VAR{eleve.nom}
				\BLOCK{endfor}
				\BLOCK{endif}
			
				&\underline{Intitulé}:
				\vspace{1cm}
				\VAR{cour.intitule}
				\vspace{1cm}
				\underline{Details Séance}:
				\vspace{1cm}
				\VAR{cour.description}
				\vspace{1cm}
				\vspace{1cm}
				\vspace{1cm}
				\vspace{1cm}
				\underline{Validé par l'enseignant ?}: \BLOCK{if cour.valider} Oui \BLOCK{else} Non \BLOCK{endif}
				&\underline{Matiere}:
				\vspace{1cm}
				\VAR{cour.matiere.codematiere}::\VAR{cour.matiere.libelle}
				\vspace{1cm}    
				\underline{Enseignant}:
				\vspace{1cm}
				\VAR{cour.enseignant.personnel}
				\vspace{1cm}
				\BLOCK{if commentaires =="on"}
				\underline{Commentaires Prof}:
				\vspace{1cm}
				\VAR{cour.commentaire}
				\BLOCK{endif}

				\\ 
				\hline 
			\BLOCK{endfor}
		\end{longtable}
		\newpage
	\BLOCK{endfor}
\BLOCK{endif}
\BLOCK{if sousCategorisation == 'chronologieHoraire'}
	\begin{longtable}{|P{4cm}|P{9cm}|P{4cm}|}
		\hline
		\LARGE\textbf{Date} & \LARGE \textbf{Description} & \LARGE \textbf{Autres} \\
		\hline
		\BLOCK{for cour in seances}
			\rule[-1ex]{0pt}{2.5ex}\underline{Date}: \vspace{1cm} \VAR{cour.date_et_heure_debut.day} - \VAR{cour.date_et_heure_debut.month} - \VAR{cour.date_et_heure_debut.year}
			\vspace{1cm}    
			\underline{Heure}:
			\vspace{1cm} 
			\VAR{cour.date_et_heure_debut.hour}h:\VAR{cour.date_et_heure_debut.minute} - \VAR{cour.date_et_heure_fin.hour}h:\VAR{cour.date_et_heure_fin.minute} 
			\vspace{1cm}
			\underline{Auteur}:
			\vspace{1cm}
			\VAR{cour.auteur.prenom} \VAR{cour.auteur.nom}
			\vspace{1cm}
			\BLOCK{if listeAbsence =="on"}
			\underline{Absents}:
			\vspace{1cm}
			\BLOCK{for eleve in cour.eleves_presents.all()}
				\VAR{eleve.prenom} \VAR{eleve.nom}
			\BLOCK{endfor}
			\BLOCK{endif}
		
			&\underline{Intitulé}:
			\vspace{1cm}
			\VAR{cour.intitule}
			\vspace{1cm}
			\underline{Details Séance}:
			\vspace{1cm}
			\VAR{cour.description}
			\vspace{1cm}
			\vspace{1cm}
			\vspace{1cm}
			\vspace{1cm}
			\underline{Validé par l'enseignant ?}: \BLOCK{if cour.valider} Oui \BLOCK{else} Non \BLOCK{endif}
			&\underline{Matiere}:
			\vspace{1cm}
			\VAR{cour.matiere.codematiere}::\VAR{cour.matiere.libelle}
			\vspace{1cm}    
			\underline{Enseignant}:
			\vspace{1cm}
			\VAR{cour.enseignant.prenom} \VAR{cour.enseignant.nom}
			\vspace{1cm}
			\BLOCK{if commentaires =="on"}
			\underline{Commentaires Prof}:
			\vspace{1cm}
			\VAR{cour.commentaire}
			\BLOCK{endif}

			\\ 
			\hline 
		\BLOCK{endfor}
	\end{longtable}
\BLOCK{endif}


\end{document}

